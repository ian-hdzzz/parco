{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate}from\"react-router-dom\";import RandomQR from'../QR/QR';import Button from\"../Form/Button\";// interfaces\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ParkingTicket=_ref=>{let{email,ticketNumber,entryTime,exitTime,amount}=_ref;const[currentAmount,setCurrentAmount]=useState(amount);const[currentTime,setCurrentTime]=useState(new Date().toLocaleTimeString());const[elapsedSeconds,setElapsedSeconds]=useState(0);const[entryDateTime,setEntryDateTime]=useState(new Date());// Valores fijos para incremento\nconst incrementPerTwoMinutes=5;// Inicializar la fecha de entrada correctamente\nuseEffect(()=>{try{// Intentar parsear la entrada como fecha\nconst parsedDate=new Date(entryTime);// Verificar si la fecha es válida\nif(!isNaN(parsedDate.getTime())){setEntryDateTime(parsedDate);}else{// Si no es válida, usar la fecha actual\nconsole.warn(\"Fecha de entrada inválida, usando la fecha actual\");setEntryDateTime(new Date());}}catch(error){console.error(\"Error al procesar la fecha de entrada:\",error);setEntryDateTime(new Date());}},[entryTime]);// Función para calcular el precio según el tiempo transcurrido desde el entryTime\nconst calculateUpdatedAmount=startDate=>{try{// Obtener la fecha y hora actual\nconst now=new Date();// Calcular los minutos transcurridos\nconst minutesDiff=Math.floor((now.getTime()-startDate.getTime())/(1000*60));// Calcular cuántos incrementos de 2 minutos han pasado\nconst increments=Math.floor(minutesDiff/2);// Calcular el nuevo monto\nconst newAmount=amount+increments*incrementPerTwoMinutes;return newAmount;}catch(error){console.error(\"Error al calcular el monto:\",error);return amount;}};// Actualizar la hora actual y el monto cada segundo\nuseEffect(()=>{// Inicializar el temporizador\nconst timer=setInterval(()=>{// Actualizar hora actual\nconst now=new Date();setCurrentTime(now.toLocaleTimeString());try{// Calcular segundos transcurridos desde el inicio\nconst secondsFromEntry=Math.floor((now.getTime()-entryDateTime.getTime())/1000);setElapsedSeconds(secondsFromEntry>0?secondsFromEntry:0);// Calcular y actualizar el monto\nconst newAmount=calculateUpdatedAmount(entryDateTime);setCurrentAmount(newAmount);}catch(error){console.error(\"Error en useEffect:\",error);}},1000);// Limpiar intervalo cuando el componente se desmonte\nreturn()=>clearInterval(timer);},[entryDateTime,amount]);// Formatear tiempo transcurrido\nconst formatElapsedTime=()=>{const hours=Math.floor(elapsedSeconds/3600);const minutes=Math.floor(elapsedSeconds%3600/60);const seconds=elapsedSeconds%60;return`${hours.toString().padStart(2,'0')}:${minutes.toString().padStart(2,'0')}:${seconds.toString().padStart(2,'0')}`;};// Formatear el monto para mostrar\nconst formattedAmount=`$${currentAmount.toFixed(2)}`;// Formatear fecha de entrada para mostrar\nconst formatEntryTime=()=>{try{return entryDateTime.toLocaleString();}catch(error){return\"Fecha inválida\";}};const navigate=useNavigate();// Inicializa el hook de navegación\nconst handleClick=()=>{const timestamp=new Date().toLocaleString();// Redirigir a la página /cards, pasando el email, timestamp y monto actual\nnavigate(\"/cards\",{state:{email,timestamp,amount:currentAmount// Pasamos el monto calculado\n}});};return/*#__PURE__*/_jsx(\"div\",{className:\"ticket no-select\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"parking-ticket-inner\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"parking-ticket-front\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"ticket-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"contactless-icon\",children:/*#__PURE__*/_jsx(\"svg\",{width:\"30\",height:\"30\",viewBox:\"0 0 24 24\",fill:\"white\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10s10-4.48,10-10S17.52,2,12,2z M8.46,14.45L7.1,13.83c0.28-0.61,0.41-1.24,0.4-1.86c-0.01-0.63-0.14-1.24-0.4-1.8l1.36-0.63c0.35,0.75,0.53,1.56,0.54,2.4C9.01,12.8,8.83,13.64,8.46,14.45z M11.53,16.01l-1.3-0.74c0.52-0.92,0.78-1.98,0.78-3.15c0-1.19-0.27-2.33-0.8-3.4l1.34-0.67c0.64,1.28,0.96,2.65,0.96,4.07C12.51,13.55,12.18,14.86,11.53,16.01z M14.67,17.33l-1.35-0.66c0.78-1.6,1.18-3.18,1.18-4.69c0-1.51-0.4-3.07-1.18-4.64l1.34-0.67C15.56,8.45,16,10.23,16,11.98C16,13.72,15.56,15.52,14.67,17.33z\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"brand-logo\",children:\"PARCO\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"ticket-number\",children:ticketNumber}),/*#__PURE__*/_jsx(\"div\",{className:\"ticket-qr\",children:/*#__PURE__*/_jsx(RandomQR,{})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ticket-details\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"USER\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:email})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"ENTRY TIME\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:formatEntryTime()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"ELAPSED TIME\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:formatElapsedTime()})]}),exitTime&&/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"EXIT TIME\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:exitTime})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"AMOUNT\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:formattedAmount})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ticket-footer\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Thank you for using our parking service.\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",text:\"Pagar\",tabIndex:0,onClick:handleClick})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"parking-ticket-back\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"ticket-back-content\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"PARCO\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Thank you for choosing our parking services.\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Please keep this ticket safe until you exit the parking area.\"}),/*#__PURE__*/_jsx(\"p\",{children:\"For assistance, contact our support at:\"}),/*#__PURE__*/_jsx(\"p\",{children:\"+1 (555) 123-4567\"}),/*#__PURE__*/_jsx(\"p\",{children:\"support@parcoapp.com\"})]})})]})});};export default ParkingTicket;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}